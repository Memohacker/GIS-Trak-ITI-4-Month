<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Islamic Salaah Timer</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: url("Domes-mosque-Malaysia.jpg") no-repeat center
          center/cover; /* üëà LOCAL IMAGE */
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        transition: background 0.3s ease;
      }
      .container {
        background: rgba(255, 255, 255, 0.85);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        text-align: center;
        width: 320px;
        backdrop-filter: blur(6px);
        transition: background 0.3s ease, color 0.3s ease;
      }
      body.dark .container {
        background: rgba(0, 0, 0, 0.75);
        color: white;
      }
      h1 {
        margin: 0 0 10px;
      }
      .clock {
        font-size: 1.5rem;
        margin: 10px 0;
      }
      .prayers {
        text-align: left;
        margin-top: 10px;
      }
      .prayers div {
        padding: 5px 0;
      }
      .highlight {
        font-weight: bold;
        color: green;
      }
      body.dark .highlight {
        color: #66ff66;
      }
      .theme-toggle {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        backdrop-filter: blur(3px);
        transition: background 0.3s ease;
      }
      body.dark .theme-toggle {
        background: rgba(255, 255, 255, 0.5);
        color: black;
      }
    </style>
  </head>
  <body>
    <button class="theme-toggle" id="themeToggle">üåô Dark</button>
    <div class="container">
      <h1>üïå Salaah Timer</h1>
      <div class="clock" id="clock">Loading...</div>
      <div class="prayers" id="prayerTimes">Fetching prayer times...</div>
    </div>

    <audio id="azanSound">
      <source
        src="https://www.islamcan.com/audio/adhan/azan1.mp3"
        type="audio/mpeg"
      />
    </audio>

    <script>
      const clock = document.getElementById("clock");
      const prayerTimesDiv = document.getElementById("prayerTimes");
      const azanSound = document.getElementById("azanSound");

      let prayerTimes = {};

      // Get user location and fetch prayer times
      navigator.geolocation.getCurrentPosition(async (pos) => {
        const { latitude, longitude } = pos.coords;
        const response = await fetch(
          `https://api.aladhan.com/v1/timings?latitude=${latitude}&longitude=${longitude}&method=2`
        );
        const data = await response.json();
        prayerTimes = data.data.timings;
        displayPrayerTimes(prayerTimes);
      });

      function displayPrayerTimes(times) {
        prayerTimesDiv.innerHTML = "";
        for (let prayer of ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"]) {
          const div = document.createElement("div");
          div.innerHTML = `${prayer}: <span>${times[prayer]}</span>`;
          div.id = prayer;
          prayerTimesDiv.appendChild(div);
        }
      }

      function updateClock() {
        const now = new Date();
        clock.textContent = now.toLocaleTimeString();

        // Check for prayer alerts
        for (let prayer of ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"]) {
          if (!prayerTimes[prayer]) continue;
          const [h, m] = prayerTimes[prayer].split(":");
          const prayerDate = new Date();
          prayerDate.setHours(h, m, 0, 0);
          if (
            now.getHours() === prayerDate.getHours() &&
            now.getMinutes() === prayerDate.getMinutes() &&
            now.getSeconds() === prayerDate.getSeconds()
          ) {
            azanSound.play();
            alert(`üïå It's time for ${prayer}!`);
            document.getElementById(prayer).classList.add("highlight");
          }
        }
      }
      setInterval(updateClock, 1000);
      updateClock();

      // Theme Toggle
      const themeToggle = document.getElementById("themeToggle");
      themeToggle.addEventListener("click", () => {
        document.body.classList.toggle("dark");
        themeToggle.textContent = document.body.classList.contains("dark")
          ? "‚òÄÔ∏è Light"
          : "üåô Dark";
      });
    </script>
  </body>
</html>
